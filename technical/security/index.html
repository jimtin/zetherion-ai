
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Privacy-first personal AI assistant with encrypted memory, smart LLM routing, and Gmail integration">
      
      
      
        <link rel="canonical" href="https://jimtin.github.io/zetherion-ai/technical/security/">
      
      
        <link rel="prev" href="../docker/">
      
      
        <link rel="next" href="../configuration/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Security - Zetherion AI</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#security-model" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Zetherion AI" class="md-header__button md-logo" aria-label="Zetherion AI" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Zetherion AI
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Security
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/jimtin/zetherion-ai" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    jimtin/zetherion-ai
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../user/getting-started/" class="md-tabs__link">
          
  
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../architecture/" class="md-tabs__link">
          
  
  
  Technical

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../development/setup/" class="md-tabs__link">
          
  
  
  Development

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../project/roadmap/" class="md-tabs__link">
          
  
  
  Project

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Zetherion AI" class="md-nav__button md-logo" aria-label="Zetherion AI" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Zetherion AI
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/jimtin/zetherion-ai" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    jimtin/zetherion-ai
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    User Guide
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    User Guide
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user/getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user/commands/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Commands
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user/gmail/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Gmail
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user/github-integration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GitHub
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user/tasks-and-calendar/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tasks & Calendar
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user/memory-and-profiles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Memory & Profiles
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user/faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FAQ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user/troubleshooting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Troubleshooting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Technical
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Technical
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../docker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Docker & Services
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Security
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Security
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Overview
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#container-security" class="md-nav__link">
    <span class="md-ellipsis">
      
        Container Security
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Container Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#distroless-images" class="md-nav__link">
    <span class="md-ellipsis">
      
        Distroless Images
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#runtime-hardening" class="md-nav__link">
    <span class="md-ellipsis">
      
        Runtime Hardening
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#encryption" class="md-nav__link">
    <span class="md-ellipsis">
      
        Encryption
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Encryption">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#field-level-encryption" class="md-nav__link">
    <span class="md-ellipsis">
      
        Field-Level Encryption
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-gets-encrypted" class="md-nav__link">
    <span class="md-ellipsis">
      
        What Gets Encrypted
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-is-not-encrypted" class="md-nav__link">
    <span class="md-ellipsis">
      
        What Is NOT Encrypted
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-management" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Management
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access-control" class="md-nav__link">
    <span class="md-ellipsis">
      
        Access Control
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Access Control">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#user-allowlist" class="md-nav__link">
    <span class="md-ellipsis">
      
        User Allowlist
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rbac-role-based-access-control" class="md-nav__link">
    <span class="md-ellipsis">
      
        RBAC (Role-Based Access Control)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skills-service-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      
        Skills Service Authentication
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prompt-injection-defense" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prompt Injection Defense
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gmail-security" class="md-nav__link">
    <span class="md-ellipsis">
      
        Gmail Security
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Gmail Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#oauth-20-flow" class="md-nav__link">
    <span class="md-ellipsis">
      
        OAuth 2.0 Flow
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#progressive-trust-system" class="md-nav__link">
    <span class="md-ellipsis">
      
        Progressive Trust System
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trust-formula" class="md-nav__link">
    <span class="md-ellipsis">
      
        Trust Formula
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#github-security" class="md-nav__link">
    <span class="md-ellipsis">
      
        GitHub Security
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#postgresql-security" class="md-nav__link">
    <span class="md-ellipsis">
      
        PostgreSQL Security
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network-security" class="md-nav__link">
    <span class="md-ellipsis">
      
        Network Security
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rate-limiting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Rate Limiting
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#logging-and-audit" class="md-nav__link">
    <span class="md-ellipsis">
      
        Logging and Audit
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Checklist
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#related-docs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Related Docs
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../skills-framework/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Skills Framework
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gmail-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Gmail Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observation-pipeline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Observation Pipeline
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../personal-understanding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Personal Understanding
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cost-tracking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cost Tracking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api-reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Development
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Development
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Setup & Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Testing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/ci-cd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CI/CD Pipeline
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/github-secrets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GitHub Secrets
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/adding-a-skill/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Adding a Skill
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Changelog
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Project
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Project
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../project/roadmap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Roadmap
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../project/design-decisions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Design Decisions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Overview
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#container-security" class="md-nav__link">
    <span class="md-ellipsis">
      
        Container Security
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Container Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#distroless-images" class="md-nav__link">
    <span class="md-ellipsis">
      
        Distroless Images
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#runtime-hardening" class="md-nav__link">
    <span class="md-ellipsis">
      
        Runtime Hardening
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#encryption" class="md-nav__link">
    <span class="md-ellipsis">
      
        Encryption
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Encryption">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#field-level-encryption" class="md-nav__link">
    <span class="md-ellipsis">
      
        Field-Level Encryption
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-gets-encrypted" class="md-nav__link">
    <span class="md-ellipsis">
      
        What Gets Encrypted
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-is-not-encrypted" class="md-nav__link">
    <span class="md-ellipsis">
      
        What Is NOT Encrypted
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-management" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Management
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access-control" class="md-nav__link">
    <span class="md-ellipsis">
      
        Access Control
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Access Control">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#user-allowlist" class="md-nav__link">
    <span class="md-ellipsis">
      
        User Allowlist
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rbac-role-based-access-control" class="md-nav__link">
    <span class="md-ellipsis">
      
        RBAC (Role-Based Access Control)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skills-service-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      
        Skills Service Authentication
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prompt-injection-defense" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prompt Injection Defense
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gmail-security" class="md-nav__link">
    <span class="md-ellipsis">
      
        Gmail Security
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Gmail Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#oauth-20-flow" class="md-nav__link">
    <span class="md-ellipsis">
      
        OAuth 2.0 Flow
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#progressive-trust-system" class="md-nav__link">
    <span class="md-ellipsis">
      
        Progressive Trust System
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trust-formula" class="md-nav__link">
    <span class="md-ellipsis">
      
        Trust Formula
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#github-security" class="md-nav__link">
    <span class="md-ellipsis">
      
        GitHub Security
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#postgresql-security" class="md-nav__link">
    <span class="md-ellipsis">
      
        PostgreSQL Security
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network-security" class="md-nav__link">
    <span class="md-ellipsis">
      
        Network Security
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rate-limiting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Rate Limiting
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#logging-and-audit" class="md-nav__link">
    <span class="md-ellipsis">
      
        Logging and Audit
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Checklist
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#related-docs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Related Docs
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="security-model">Security Model<a class="headerlink" href="#security-model" title="Permanent link">&para;</a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>Zetherion AI implements a defense-in-depth security architecture spanning multiple layers: container hardening with distroless images, field-level encryption at rest using AES-256-GCM, role-based access control backed by PostgreSQL, prompt injection defense with 17 regex patterns and Unicode analysis, progressive trust for Gmail automation, and network isolation via Docker bridge networking. Each layer operates independently so that a breach at one level does not compromise the entire system.</p>
<h2 id="container-security">Container Security<a class="headerlink" href="#container-security" title="Permanent link">&para;</a></h2>
<h3 id="distroless-images">Distroless Images<a class="headerlink" href="#distroless-images" title="Permanent link">&para;</a></h3>
<p>The bot and skills services use Google's <code>gcr.io/distroless/python3-debian12:nonroot</code> as the runtime base image. Distroless images contain only the application and its runtime dependencies. They do not include:</p>
<ul>
<li>No shell (<code>/bin/sh</code>, <code>/bin/bash</code>)</li>
<li>No package manager (<code>apt</code>, <code>yum</code>, <code>apk</code>)</li>
<li>No system utilities (<code>curl</code>, <code>wget</code>, <code>nc</code>)</li>
<li>No OS libraries beyond what the application requires</li>
</ul>
<p>This reduces the container image size by approximately 70% compared to <code>python:3.11-slim</code> and eliminates the tools an attacker would need for lateral movement, reconnaissance, or privilege escalation after gaining code execution.</p>
<p>The image runs as the <code>nonroot</code> user (UID 65532) by default, preventing root-level filesystem access even if a container escape were attempted.</p>
<h3 id="runtime-hardening">Runtime Hardening<a class="headerlink" href="#runtime-hardening" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Control</th>
<th>Detail</th>
</tr>
</thead>
<tbody>
<tr>
<td>Read-only root filesystem</td>
<td><code>read_only: true</code> in Docker Compose; writable paths via <code>tmpfs</code> for <code>/tmp</code></td>
</tr>
<tr>
<td>No new privileges</td>
<td><code>security_opt: no-new-privileges:true</code> on all containers</td>
</tr>
<tr>
<td>Resource limits</td>
<td>CPU and memory quotas via Docker Compose <code>deploy.resources</code></td>
</tr>
<tr>
<td>Network isolation</td>
<td>All services communicate on a dedicated <code>zetherion_ai-net</code> bridge network</td>
</tr>
<tr>
<td>Health checks</td>
<td>TCP-based health checks with intervals, timeouts, retries, and start periods</td>
</tr>
<tr>
<td>Restart policy</td>
<td><code>unless-stopped</code> for automatic recovery</td>
</tr>
</tbody>
</table>
<h2 id="encryption">Encryption<a class="headerlink" href="#encryption" title="Permanent link">&para;</a></h2>
<h3 id="field-level-encryption">Field-Level Encryption<a class="headerlink" href="#field-level-encryption" title="Permanent link">&para;</a></h3>
<p>All sensitive data stored in Qdrant and PostgreSQL is encrypted at the application layer before being written to disk.</p>
<ul>
<li><strong>Algorithm</strong>: AES-256-GCM (authenticated encryption providing both confidentiality and integrity)</li>
<li><strong>Key derivation</strong>: PBKDF2-HMAC-SHA256 with 600,000 iterations (OWASP-recommended count)</li>
<li><strong>Salt</strong>: Random 256-bit (32 bytes), persisted at <code>ENCRYPTION_SALT_PATH</code></li>
<li><strong>Per-field encryption</strong>: Each field encryption generates a unique random 96-bit nonce/IV</li>
<li><strong>Tamper detection</strong>: GCM authentication tag detects any modification to ciphertext</li>
</ul>
<h3 id="what-gets-encrypted">What Gets Encrypted<a class="headerlink" href="#what-gets-encrypted" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Collection / Store</th>
<th>Encrypted Fields</th>
<th>Plaintext Fields</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>conversations</code></td>
<td><code>content</code></td>
<td><code>user_id</code>, <code>channel_id</code>, <code>role</code>, <code>timestamp</code></td>
</tr>
<tr>
<td><code>long_term_memory</code></td>
<td><code>content</code></td>
<td><code>type</code>, <code>timestamp</code>, metadata</td>
</tr>
<tr>
<td><code>user_profiles</code></td>
<td><code>key</code>, <code>value</code></td>
<td><code>category</code>, <code>confidence</code>, <code>user_id</code></td>
</tr>
<tr>
<td><code>skill_tasks</code></td>
<td><code>title</code>, <code>description</code></td>
<td><code>status</code>, <code>priority</code>, <code>deadline</code></td>
</tr>
<tr>
<td>Gmail tokens</td>
<td><code>access_token</code>, <code>refresh_token</code></td>
<td><code>user_id</code>, <code>expiry</code></td>
</tr>
</tbody>
</table>
<h3 id="what-is-not-encrypted">What Is NOT Encrypted<a class="headerlink" href="#what-is-not-encrypted" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Vector embeddings</strong>: Required for similarity search in Qdrant. Encrypting embeddings would destroy the distance properties that make vector search possible.</li>
<li><strong>Metadata</strong>: Timestamps, IDs, user IDs, and other structural data needed for indexing and queries.</li>
<li><strong>Configuration data</strong>: Settings stored in PostgreSQL dynamic settings table.</li>
</ul>
<h3 id="key-management">Key Management<a class="headerlink" href="#key-management" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>ENCRYPTION_PASSPHRASE=minimum-16-character-passphrase
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>ENCRYPTION_SALT_PATH=data/salt.bin
</code></pre></div>
<ul>
<li>The passphrase is loaded as a <code>SecretStr</code> and never stored in the database or logged.</li>
<li>The salt file is generated automatically on first run and must be backed up. Loss of the salt file means loss of all encrypted data.</li>
<li>Key rotation is supported via <code>KeyManager.rotate_key()</code> but requires a data migration step to re-encrypt all existing records.</li>
</ul>
<h2 id="access-control">Access Control<a class="headerlink" href="#access-control" title="Permanent link">&para;</a></h2>
<h3 id="user-allowlist">User Allowlist<a class="headerlink" href="#user-allowlist" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>ALLOWED_USER_IDS=123456789,987654321
</code></pre></div>
<ul>
<li>When set, only the listed Discord user IDs can interact with the bot.</li>
<li>When empty, all users are permitted (a warning is logged at startup).</li>
<li>Checked on every incoming message before any processing occurs.</li>
<li>Users can be added or removed at runtime via <code>UserAllowlist.add()</code> and <code>.remove()</code>.</li>
</ul>
<h3 id="rbac-role-based-access-control">RBAC (Role-Based Access Control)<a class="headerlink" href="#rbac-role-based-access-control" title="Permanent link">&para;</a></h3>
<p>PostgreSQL-backed user management provides three roles with distinct permission boundaries:</p>
<table>
<thead>
<tr>
<th>Role</th>
<th>Permissions</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>owner</code></td>
<td>Full system control, manage admin users, change all settings</td>
</tr>
<tr>
<td><code>admin</code></td>
<td>Manage regular users, change non-critical settings</td>
</tr>
<tr>
<td><code>user</code></td>
<td>Standard bot interaction, no administrative capabilities</td>
</tr>
</tbody>
</table>
<p>The bootstrap admin is set via the <code>OWNER_USER_ID</code> environment variable. This user is automatically assigned the <code>owner</code> role on first startup.</p>
<p>RBAC is managed through the Skills Service API:</p>
<table>
<thead>
<tr>
<th>Endpoint</th>
<th>Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/users</code></td>
<td>POST</td>
<td>Add a user with a specified role</td>
</tr>
<tr>
<td><code>/users/{id}/role</code></td>
<td>PATCH</td>
<td>Change a user's role</td>
</tr>
<tr>
<td><code>/users/{id}</code></td>
<td>DELETE</td>
<td>Remove a user's access</td>
</tr>
<tr>
<td><code>/users/audit</code></td>
<td>GET</td>
<td>Retrieve the RBAC audit trail</td>
</tr>
</tbody>
</table>
<p>All role changes are recorded in the PostgreSQL audit trail with timestamps, the acting user, and the action performed.</p>
<h3 id="skills-service-authentication">Skills Service Authentication<a class="headerlink" href="#skills-service-authentication" title="Permanent link">&para;</a></h3>
<p>All non-health endpoints on the Skills Service require an <code>X-API-Secret</code> header:</p>
<ul>
<li>The secret is configured via <code>SKILLS_API_SECRET</code> in the environment.</li>
<li>Comparison uses HMAC-based constant-time comparison to prevent timing attacks.</li>
<li>The health endpoint (<code>/health</code>) bypasses authentication to allow monitoring and orchestration tools to check service status.</li>
</ul>
<h2 id="prompt-injection-defense">Prompt Injection Defense<a class="headerlink" href="#prompt-injection-defense" title="Permanent link">&para;</a></h2>
<p>Every user message is checked before being forwarded to any LLM backend. The defense system is implemented in <code>src/zetherion_ai/discord/security.py</code> and operates in three layers:</p>
<ol>
<li>
<p><strong>Regex pattern matching</strong>: 17 case-insensitive patterns detect common injection techniques including "ignore previous instructions", "you are now a...", "system prompt:", "jailbreak", "DAN mode", and "disable/bypass filters" variations. Patterns account for spacing, punctuation, and phrasing differences.</p>
</li>
<li>
<p><strong>Unicode obfuscation detection</strong>: Compares NFKC-normalized text to the original. A length difference exceeding 10% indicates homoglyph substitution (for example, Cyrillic characters replacing Latin ones to bypass keyword filters).</p>
</li>
<li>
<p><strong>Roleplay marker heuristic</strong>: Flags messages containing more than 5 bracket pairs or <code>(system</code> markers, which indicate structured injection attempts.</p>
</li>
</ol>
<p>Flagged messages are logged with the matched pattern and rejected before reaching any LLM. Graceful degradation ensures that if the Unicode check fails, it is skipped rather than crashing the message pipeline.</p>
<h2 id="gmail-security">Gmail Security<a class="headerlink" href="#gmail-security" title="Permanent link">&para;</a></h2>
<h3 id="oauth-20-flow">OAuth 2.0 Flow<a class="headerlink" href="#oauth-20-flow" title="Permanent link">&para;</a></h3>
<p>Gmail integration uses the standard OAuth 2.0 authorization code flow:</p>
<ul>
<li><strong>Scopes requested</strong>: <code>gmail.readonly</code> (minimum required), <code>gmail.send</code> (granted only when trust thresholds are met)</li>
<li><strong>Token storage</strong>: Access tokens and refresh tokens are encrypted at rest using the same AES-256-GCM field encryption used for all other sensitive data</li>
<li><strong>Token refresh</strong>: Handled automatically when the access token expires</li>
<li><strong>Configuration</strong>: Requires <code>GOOGLE_CLIENT_ID</code>, <code>GOOGLE_CLIENT_SECRET</code>, and <code>GOOGLE_REDIRECT_URI</code> environment variables</li>
</ul>
<h3 id="progressive-trust-system">Progressive Trust System<a class="headerlink" href="#progressive-trust-system" title="Permanent link">&para;</a></h3>
<p>Gmail automation uses a two-dimensional trust model to gradually increase autonomy based on demonstrated reliability:</p>
<p><strong>Trust dimensions</strong>:
- <strong>Contact trust</strong>: Trust level specific to a particular email contact, reflecting the history of interactions with that person
- <strong>Reply type trust</strong>: Trust level specific to the category of reply (e.g., informational, scheduling, sensitive)</p>
<p><strong>Trust evolution</strong>:
| User Action | Trust Delta |
|-------------|------------|
| Approval (send as-is) | +0.05 |
| Minor edit (small changes) | -0.02 |
| Major edit (significant rewrite) | -0.10 |
| Rejection (discard draft) | -0.20 |</p>
<p><strong>Auto-send thresholds</strong>:
- Trust starts at 0.0 for all new contacts and reply types
- Auto-send requires: <code>effective_trust &gt;= 0.85</code> AND <code>confidence &gt;= 0.85</code>
- Global trust cap: 0.95 (the system never becomes fully autonomous)
- Reply type ceilings limit trust by category (e.g., <code>SENSITIVE</code> replies are capped at 0.30)</p>
<h3 id="trust-formula">Trust Formula<a class="headerlink" href="#trust-formula" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>effective_trust = min(type_trust, contact_trust, reply_type_ceiling)
</code></pre></div>
<p>The effective trust is the minimum of the three values, ensuring that all dimensions must independently reach the threshold before automation is permitted. This prevents a high contact trust from overriding a low reply type ceiling for sensitive communications.</p>
<h2 id="github-security">GitHub Security<a class="headerlink" href="#github-security" title="Permanent link">&para;</a></h2>
<ul>
<li>The personal access token is stored in <code>.env</code> as <code>GITHUB_TOKEN</code> and loaded as a <code>SecretStr</code>. It is never stored in the database.</li>
<li>Configurable autonomy levels control which actions the bot can perform without confirmation.</li>
<li>High-risk actions (such as merging a pull request or deleting a branch) always require explicit user confirmation regardless of autonomy settings.</li>
<li>All GitHub actions are logged in the audit trail with the action type, repository, and outcome.</li>
</ul>
<h2 id="postgresql-security">PostgreSQL Security<a class="headerlink" href="#postgresql-security" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Control</th>
<th>Detail</th>
</tr>
</thead>
<tbody>
<tr>
<td>Network exposure</td>
<td>Internal Docker network only; no host port mapping by default</td>
</tr>
<tr>
<td>Credentials</td>
<td>Stored in <code>.env</code> file, loaded via <code>POSTGRES_DSN</code></td>
</tr>
<tr>
<td>Connection</td>
<td>Via internal Docker bridge network (<code>zetherion_ai-net</code>)</td>
</tr>
<tr>
<td>Password policy</td>
<td>Production deployments should use strong, randomly generated passwords</td>
</tr>
<tr>
<td>Data stored</td>
<td>RBAC users and roles, dynamic settings, audit trail, Gmail trust state</td>
</tr>
</tbody>
</table>
<p>The PostgreSQL container is not exposed to the host network. Only containers on the <code>zetherion_ai-net</code> bridge can connect to it.</p>
<h2 id="network-security">Network Security<a class="headerlink" href="#network-security" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Control</th>
<th>Detail</th>
</tr>
</thead>
<tbody>
<tr>
<td>Internal network</td>
<td>All services communicate on the <code>zetherion_ai-net</code> Docker bridge network</td>
</tr>
<tr>
<td>Host exposure</td>
<td>Only Qdrant (6333) and Ollama (11434) are mapped to host ports (for development/testing)</td>
</tr>
<tr>
<td>Bot/Skills communication</td>
<td>Via internal network; no external ingress required</td>
</tr>
<tr>
<td>External API calls</td>
<td>All outbound API calls (Anthropic, OpenAI, Gemini, Discord) use HTTPS via <code>httpx</code></td>
</tr>
<tr>
<td>No inbound web server</td>
<td>The bot connects outbound to Discord's WebSocket gateway and does not listen on any HTTP port</td>
</tr>
</tbody>
</table>
<h2 id="rate-limiting">Rate Limiting<a class="headerlink" href="#rate-limiting" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Environment Variable</th>
</tr>
</thead>
<tbody>
<tr>
<td>Max messages per window</td>
<td>10</td>
<td><code>RATE_LIMIT_MESSAGES</code></td>
</tr>
<tr>
<td>Window duration</td>
<td>60 seconds</td>
<td><code>RATE_LIMIT_WINDOW</code></td>
</tr>
<tr>
<td>Warning cooldown</td>
<td>30 seconds</td>
<td>(hardcoded)</td>
</tr>
</tbody>
</table>
<p>Rate limiting is per-user with automatic timestamp cleanup. When a user exceeds the limit, a warning message is returned, throttled to one warning per cooldown period to avoid spam.</p>
<h2 id="logging-and-audit">Logging and Audit<a class="headerlink" href="#logging-and-audit" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Layer</th>
<th>Implementation</th>
</tr>
</thead>
<tbody>
<tr>
<td>Structured logging</td>
<td><code>structlog</code> with JSON output (production) or colored console (development)</td>
</tr>
<tr>
<td>Log rotation</td>
<td><code>RotatingFileHandler</code>: 50MB max per file, 10 backup files</td>
</tr>
<tr>
<td>Separate error log</td>
<td>WARNING-level and above written to a dedicated error log file</td>
</tr>
<tr>
<td>Credential protection</td>
<td><code>SecretStr</code> objects log as <code>'**********'</code>; passphrase never appears in logs</td>
</tr>
<tr>
<td>RBAC audit trail</td>
<td>All role changes recorded in PostgreSQL with timestamp, actor, and action</td>
</tr>
<tr>
<td>Gmail trust events</td>
<td>Trust score changes logged with contact, reply type, action, and new trust values</td>
</tr>
<tr>
<td>GitHub actions</td>
<td>All API operations logged with action type, repository, and result</td>
</tr>
<tr>
<td>Security events</td>
<td>Prompt injection attempts, allowlist changes, and rate limit triggers logged</td>
</tr>
<tr>
<td>Third-party noise</td>
<td>Discord and httpx loggers set to WARNING level</td>
</tr>
</tbody>
</table>
<h2 id="security-checklist">Security Checklist<a class="headerlink" href="#security-checklist" title="Permanent link">&para;</a></h2>
<ul>
<li>[ ] Set <code>ALLOWED_USER_IDS</code> to restrict access in production</li>
<li>[ ] Set a strong <code>ENCRYPTION_PASSPHRASE</code> (minimum 16 characters, recommend 32+)</li>
<li>[ ] Back up the salt file (<code>data/salt.bin</code>) securely and separately from the repository</li>
<li>[ ] Set <code>SKILLS_API_SECRET</code> for Skills Service authentication</li>
<li>[ ] Use a strong, randomly generated PostgreSQL password in <code>POSTGRES_DSN</code></li>
<li>[ ] Review rate limit settings for your expected usage pattern</li>
<li>[ ] Enable Message Content Intent in the Discord Developer Portal</li>
<li>[ ] Never commit <code>.env</code> to version control</li>
<li>[ ] Set <code>OWNER_USER_ID</code> for RBAC bootstrap</li>
<li>[ ] Review Gmail OAuth scopes and trust thresholds before enabling email automation</li>
<li>[ ] Store <code>GITHUB_TOKEN</code> only in <code>.env</code>, never in code or database</li>
</ul>
<h2 id="related-docs">Related Docs<a class="headerlink" href="#related-docs" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="../architecture/">Architecture</a> -- System design and component interactions</li>
<li><a href="../configuration/">Configuration Reference</a> -- Complete environment variable reference</li>
<li><a href="../docker/">Docker Deployment</a> -- Container setup and orchestration</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/jimtin/zetherion-ai" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.top", "search.suggest", "search.highlight", "content.code.copy"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>